<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nexus USA - Ultimate Database</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Roboto:wght@300;400;700&display=swap');

        :root {
            --neon-blue: #00f3ff;
            --neon-green: #00ff41;
            --neon-red: #ff3333;
            --neon-yellow: #f3ff00;
            --bg-color: #050505;
            --card-bg: rgba(20, 20, 30, 0.6);
            --text-main: #ffffff;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            background-color: var(--bg-color);
            color: var(--text-main);
            font-family: 'Roboto', sans-serif;
            overflow-x: hidden;
            min-height: 100vh;
        }

        /* CANVAS BACKGROUND */
        #particles-canvas {
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            z-index: -1;
            background: radial-gradient(circle at center, #0a0a12 0%, #000000 100%);
        }

        .container { max-width: 1200px; margin: 0 auto; padding: 20px; position: relative; z-index: 1; }

        /* HEADER */
        header {
            text-align: center;
            padding: 30px 0;
            border-bottom: 2px solid var(--neon-blue);
            margin-bottom: 30px;
            position: relative;
        }

        h1 {
            font-family: 'Orbitron', sans-serif;
            font-size: 3rem;
            color: var(--neon-blue);
            text-transform: uppercase;
            letter-spacing: 5px;
            text-shadow: 0 0 15px var(--neon-blue);
        }

        /* MAP SECTION */
        .map-container {
            display: flex;
            justify-content: center;
            margin-bottom: 30px;
        }
        
        svg.us-map {
            width: 100%;
            max-width: 800px;
            height: auto;
            filter: drop-shadow(0 0 5px var(--neon-blue));
        }

        .map-region {
            fill: rgba(0, 243, 255, 0.1);
            stroke: var(--neon-blue);
            stroke-width: 1;
            transition: 0.3s;
            cursor: pointer;
        }

        .map-region:hover {
            fill: rgba(0, 243, 255, 0.4);
            filter: drop-shadow(0 0 8px var(--neon-blue));
        }

        .map-region.active-region {
            fill: var(--neon-blue);
            stroke: #fff;
        }

        /* CONTROLS */
        .controls-panel {
            background: rgba(0,0,0,0.7);
            border: 1px solid #333;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 30px;
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            justify-content: space-between;
            align-items: center;
            backdrop-filter: blur(5px);
        }

        .search-box { flex: 1; min-width: 200px; }
        
        input {
            padding: 12px;
            border-radius: 5px;
            border: 1px solid var(--neon-blue);
            background: rgba(0,0,0,0.5);
            color: #fff;
            width: 100%;
            font-family: 'Orbitron', sans-serif;
            outline: none;
        }
        
        .filter-buttons { display: flex; gap: 10px; flex-wrap: wrap; }

        button {
            padding: 10px 15px;
            border: 1px solid var(--neon-blue);
            background: rgba(0, 243, 255, 0.05);
            color: var(--neon-blue);
            font-family: 'Orbitron', sans-serif;
            cursor: pointer;
            transition: 0.3s;
            font-size: 0.8rem;
            text-transform: uppercase;
        }

        button:hover, button.active {
            background: var(--neon-blue);
            color: #000;
            box-shadow: 0 0 10px var(--neon-blue);
        }

        select {
            padding: 10px;
            background: #000;
            color: var(--neon-green);
            border: 1px solid var(--neon-green);
            font-family: 'Orbitron';
            cursor: pointer;
        }

        /* GRID */
        #statesGrid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 20px;
        }

        /* CARD DESIGN */
        .card {
            background: var(--card-bg);
            border: 1px solid rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 5px;
            transition: 0.3s;
            cursor: pointer;
            position: relative;
            backdrop-filter: blur(8px);
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            min-height: 220px;
        }

        .card:hover { 
            transform: translateY(-5px); 
            border-color: rgba(255,255,255,0.4);
            box-shadow: 0 5px 15px rgba(0,0,0,0.5);
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
        }

        .flag { font-size: 2.5rem; }

        .card h3 {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.3rem;
            margin-top: 10px;
            margin-bottom: 5px;
            color: #fff;
        }

        .card-tag {
            font-size: 0.7rem;
            color: #888;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 10px;
        }

        .stats-row {
            font-size: 0.8rem;
            color: #ccc;
            margin-top: 10px;
            border-top: 1px solid #333;
            padding-top: 10px;
        }

        .view-btn {
            margin-top: 15px;
            padding: 8px;
            text-align: center;
            font-family: 'Orbitron';
            font-size: 0.8rem;
            border: 1px solid;
            transition: 0.3s;
        }

        .btn-success { border-color: var(--neon-green); color: var(--neon-green); }
        .card:hover .btn-success { background: var(--neon-green); color: #000; box-shadow: 0 0 10px var(--neon-green); }

        .btn-danger { border-color: var(--neon-red); color: var(--neon-red); opacity: 0.7; }
        
        /* BORDERS */
        .border-green { border-left: 3px solid var(--neon-green); }
        .border-yellow { border-left: 3px solid var(--neon-yellow); }
        .border-blue { border-left: 3px solid var(--neon-blue); }

        /* MODAL */
        .modal {
            display: none;
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.9);
            backdrop-filter: blur(10px);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            opacity: 0;
            transition: opacity 0.3s;
        }
        .modal.show { opacity: 1; }

        .modal-content {
            background: #111;
            border: 1px solid var(--neon-blue);
            padding: 40px;
            width: 90%; max-width: 700px;
            max-height: 80vh;
            overflow-y: auto;
            position: relative;
            box-shadow: 0 0 30px rgba(0, 243, 255, 0.1);
        }

        .close-btn {
            position: absolute; top: 15px; right: 20px;
            font-size: 2rem; color: var(--neon-red); cursor: pointer;
        }

        #modalTitle { color: var(--neon-blue); font-family: 'Orbitron'; margin-bottom: 20px; border-bottom: 1px solid #333; padding-bottom: 10px; }
        #modalBody { line-height: 1.6; color: #ddd; }
        #modalBody strong { color: #fff; }

        /* SCROLLBAR */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #000; }
        ::-webkit-scrollbar-thumb { background: #333; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: var(--neon-blue); }

    </style>
</head>
<body>

    <canvas id="particles-canvas"></canvas>

    <div class="container">
        <header>
            <h1>NEXUS DATABASE</h1>
            <p style="color: #888; font-family: 'Orbitron'; letter-spacing: 2px;">SECURE ACCESS TERMINAL V.3.1</p>
        </header>

        <div class="map-container">
            <svg class="us-map" viewBox="0 0 800 500" xmlns="http://www.w3.org/2000/svg">
                <defs>
                    <pattern id="grid" width="20" height="20" patternUnits="userSpaceOnUse">
                        <path d="M 20 0 L 0 0 0 20" fill="none" stroke="rgba(0, 243, 255, 0.1)" stroke-width="1"/>
                    </pattern>
                </defs>
                
                <path id="region-west" class="map-region" d="M 50,50 L 250,50 L 250,300 L 150,400 L 50,350 Z" onclick="filterByRegion('West')"/>
                <text x="120" y="200" fill="#fff" font-family="Orbitron" font-size="14" pointer-events="none">WEST</text>

                <path id="region-midwest" class="map-region" d="M 260,50 L 500,50 L 480,250 L 260,250 Z" onclick="filterByRegion('Midwest')"/>
                <text x="350" y="150" fill="#fff" font-family="Orbitron" font-size="14" pointer-events="none">MIDWEST</text>

                <path id="region-northeast" class="map-region" d="M 510,40 L 750,20 L 780,200 L 510,200 Z" onclick="filterByRegion('Northeast')"/>
                <text x="600" y="120" fill="#fff" font-family="Orbitron" font-size="14" pointer-events="none">NORTHEAST</text>

                <path id="region-south" class="map-region" d="M 260,260 L 500,260 L 550,400 L 300,450 Z" onclick="filterByRegion('South')"/>
                <text x="400" y="350" fill="#fff" font-family="Orbitron" font-size="14" pointer-events="none">SOUTH</text>

                <circle id="region-territories" class="map-region" cx="700" cy="350" r="40" onclick="filterByRegion('Territories')" style="stroke: var(--neon-yellow);"/>
                <text x="670" y="355" fill="#fff" font-family="Orbitron" font-size="10" pointer-events="none">ISLANDS</text>

                <line x1="250" y1="50" x2="260" y2="50" stroke="var(--neon-blue)" stroke-width="2"/>
                <line x1="500" y1="50" x2="510" y2="40" stroke="var(--neon-blue)" stroke-width="2"/>
            </svg>
        </div>

        <div class="controls-panel">
            <div class="search-box">
                <input type="text" id="searchInput" placeholder="SEARCH NODE..." oninput="renderGrid()">
            </div>
            
            <div class="filter-buttons">
                <button onclick="setFilter('all')" class="active" id="btn-all">ALL</button>
                <button onclick="setFilter('states')" id="btn-states">STATES</button>
                <button onclick="setFilter('territories')" id="btn-territories" style="border-color: var(--neon-yellow);">TERRITORIES</button>
                <button onclick="toggleLang()" id="langBtn">LANG: ENG</button>
            </div>

            <div class="sort-box">
                <select id="sortSelect" onchange="renderGrid()">
                    <option value="name">SORT: A-Z</option>
                    <option value="pop">SORT: POPULATION</option>
                </select>
            </div>
        </div>

        <div id="statesGrid"></div>
    </div>

    <div id="infoModal" class="modal" onclick="closeModal(event)">
        <div class="modal-content">
            <span class="close-btn" onclick="closeModal(event, true)">&times;</span>
            <h2 id="modalTitle"></h2>
            <div id="modalBody"></div>
        </div>
    </div>

    <script>
        // --- DATA ---
        const DATA = {
            'Puerto Rico': {
                type: 'territory', flag: 'ğŸ‡µğŸ‡·', region: 'Territories', pop: 3200000,
                en: { 
                    title: "Commonwealth of Puerto Rico", 
                    desc: `<p><strong>Overview:</strong> An unincorporated territory of the United States located in the northeast Caribbean Sea. It is an archipelago that includes the main island of Puerto Rico and a number of smaller ones such as Mona, Culebra, and Vieques.</p>
                           <ul>
                               <li><strong>Capital:</strong> San Juan</li>
                               <li><strong>Population:</strong> ~3.2 Million</li>
                               <li><strong>Citizenship:</strong> Puerto Ricans are U.S. citizens by birth (since 1917).</li>
                               <li><strong>Economy:</strong> The strongest in the Caribbean, driven by manufacturing (pharmaceuticals, electronics) and tourism.</li>
                               <li><strong>Geography:</strong> Mostly mountainous with large coastal areas and the famous El Yunque tropical rainforest.</li>
                           </ul>` 
                },
                geo: { 
                    title: "áƒáƒ£áƒ”áƒ áƒ¢áƒ áƒ áƒ˜áƒ™áƒáƒ¡ áƒ—áƒáƒœáƒáƒ›áƒ”áƒ’áƒáƒ‘áƒ áƒáƒ‘áƒ", 
                    desc: `<p><strong>áƒ›áƒ˜áƒ›áƒáƒ®áƒ˜áƒšáƒ•áƒ:</strong> áƒáƒ¨áƒ¨-áƒ˜áƒ¡ áƒáƒ áƒáƒ˜áƒœáƒ™áƒáƒ áƒáƒáƒ áƒ˜áƒ áƒ”áƒ‘áƒ£áƒšáƒ˜ áƒ¢áƒ”áƒ áƒ˜áƒ¢áƒáƒ áƒ˜áƒ áƒ™áƒáƒ áƒ˜áƒ‘áƒ˜áƒ¡ áƒ–áƒ¦áƒ•áƒáƒ¨áƒ˜. áƒ¨áƒ”áƒ“áƒ’áƒ”áƒ‘áƒ áƒ›áƒ—áƒáƒ•áƒáƒ áƒ˜ áƒ™áƒ£áƒœáƒ«áƒ£áƒšáƒ˜áƒ¡áƒ áƒ“áƒ áƒ áƒáƒ›áƒ“áƒ”áƒœáƒ˜áƒ›áƒ” áƒáƒáƒ¢áƒáƒ áƒ áƒ™áƒ£áƒœáƒ«áƒ£áƒšáƒ˜áƒ¡áƒ’áƒáƒœ (áƒ™áƒ£áƒšáƒ”áƒ‘áƒ áƒ, áƒ•áƒ˜áƒ”áƒ™áƒ”áƒ¡áƒ˜).</p>
                           <ul>
                               <li><strong>áƒ“áƒ”áƒ“áƒáƒ¥áƒáƒšáƒáƒ¥áƒ˜:</strong> áƒ¡áƒáƒœ-áƒ®áƒ£áƒáƒœáƒ˜</li>
                               <li><strong>áƒ›áƒáƒ¡áƒáƒ®áƒšáƒ”áƒáƒ‘áƒ:</strong> ~3.2 áƒ›áƒ˜áƒšáƒ˜áƒáƒœáƒ˜</li>
                               <li><strong>áƒ›áƒáƒ¥áƒáƒšáƒáƒ¥áƒ”áƒáƒ‘áƒ:</strong> áƒ›áƒáƒ¡áƒáƒ®áƒšáƒ”áƒáƒ‘áƒ áƒáƒ¨áƒ¨-áƒ˜áƒ¡ áƒ›áƒáƒ¥áƒáƒšáƒáƒ¥áƒ”áƒ áƒ“áƒáƒ‘áƒáƒ“áƒ”áƒ‘áƒ˜áƒ— (1917 áƒ¬áƒšáƒ˜áƒ“áƒáƒœ).</li>
                               <li><strong>áƒ”áƒ™áƒáƒœáƒáƒ›áƒ˜áƒ™áƒ:</strong> áƒ áƒ”áƒ’áƒ˜áƒáƒœáƒ¨áƒ˜ áƒ§áƒ•áƒ”áƒšáƒáƒ–áƒ” áƒ«áƒšáƒ˜áƒ”áƒ áƒ˜ áƒ”áƒ™áƒáƒœáƒáƒ›áƒ˜áƒ™áƒ. áƒ›áƒ—áƒáƒ•áƒáƒ áƒ˜ áƒ“áƒáƒ áƒ’áƒ”áƒ‘áƒ˜áƒ áƒ¤áƒáƒ áƒ›áƒáƒªáƒ”áƒ•áƒ¢áƒ˜áƒ™áƒ áƒ“áƒ áƒ¢áƒ£áƒ áƒ˜áƒ–áƒ›áƒ˜.</li>
                               <li><strong>áƒ‘áƒ£áƒœáƒ”áƒ‘áƒ:</strong> áƒ›áƒ—áƒ˜áƒáƒœáƒ˜ áƒ áƒ”áƒšáƒ˜áƒ”áƒ¤áƒ˜ áƒ“áƒ áƒ”áƒš-áƒ˜áƒ£áƒœáƒ™áƒ”áƒ¡ áƒ¢áƒ áƒáƒáƒ˜áƒ™áƒ£áƒšáƒ˜ áƒ¢áƒ§áƒ”.</li>
                           </ul>` 
                }
            },
            'Guam': {
                type: 'territory', flag: 'ğŸ‡¬ğŸ‡º', region: 'Territories', pop: 170000,
                en: { 
                    title: "Territory of Guam", 
                    desc: `<p><strong>Overview:</strong> An organized, unincorporated territory of the United States in the Micronesia subregion of the western Pacific Ocean. It is the westernmost point of U.S. territory.</p>
                           <ul>
                               <li><strong>Capital:</strong> HagÃ¥tÃ±a</li>
                               <li><strong>Strategic Importance:</strong> Guam is home to huge U.S. military bases (Navy and Air Force), covering nearly 30% of the island.</li>
                               <li><strong>Culture:</strong> Indigenous Chamorro culture is dominant, mixed with Spanish and American influences.</li>
                               <li><strong>Tourism:</strong> A major destination for tourists from Japan and South Korea.</li>
                           </ul>` 
                },
                geo: { 
                    title: "áƒ’áƒ£áƒáƒ›áƒ˜áƒ¡ áƒ¢áƒ”áƒ áƒ˜áƒ¢áƒáƒ áƒ˜áƒ", 
                    desc: `<p><strong>áƒ›áƒ˜áƒ›áƒáƒ®áƒ˜áƒšáƒ•áƒ:</strong> áƒáƒ¨áƒ¨-áƒ˜áƒ¡ áƒáƒ áƒáƒ˜áƒœáƒ™áƒáƒ áƒáƒáƒ áƒ˜áƒ áƒ”áƒ‘áƒ£áƒšáƒ˜ áƒ¢áƒ”áƒ áƒ˜áƒ¢áƒáƒ áƒ˜áƒ áƒ¬áƒ§áƒœáƒáƒ  áƒáƒ™áƒ”áƒáƒœáƒ”áƒ¨áƒ˜ (áƒ›áƒ˜áƒ™áƒ áƒáƒœáƒ”áƒ–áƒ˜áƒ). áƒ”áƒ¡ áƒáƒ áƒ˜áƒ¡ áƒáƒ¨áƒ¨-áƒ˜áƒ¡ áƒ§áƒ•áƒ”áƒšáƒáƒ–áƒ” áƒ“áƒáƒ¡áƒáƒ•áƒšáƒ”áƒ—áƒ˜ áƒ¬áƒ”áƒ áƒ¢áƒ˜áƒšáƒ˜.</p>
                           <ul>
                               <li><strong>áƒ“áƒ”áƒ“áƒáƒ¥áƒáƒšáƒáƒ¥áƒ˜:</strong> áƒ°áƒáƒ’áƒáƒ¢áƒœáƒ</li>
                               <li><strong>áƒ›áƒœáƒ˜áƒ¨áƒ•áƒœáƒ”áƒšáƒáƒ‘áƒ:</strong> áƒ™áƒ£áƒœáƒ«áƒ£áƒšáƒ˜áƒ¡ 30% áƒ£áƒ™áƒáƒ•áƒ˜áƒ áƒáƒ¨áƒ¨-áƒ˜áƒ¡ áƒ¡áƒáƒ›áƒ®áƒ”áƒ“áƒ áƒ áƒ‘áƒáƒ–áƒ”áƒ‘áƒ¡, áƒ áƒáƒª áƒ›áƒáƒ¡ áƒ¡áƒ¢áƒ áƒáƒ¢áƒ”áƒ’áƒ˜áƒ£áƒš áƒ°áƒáƒ‘áƒáƒ“ áƒáƒ¥áƒªáƒ”áƒ•áƒ¡.</li>
                               <li><strong>áƒ™áƒ£áƒšáƒ¢áƒ£áƒ áƒ:</strong> áƒ“áƒáƒ›áƒ˜áƒœáƒ˜áƒ áƒ”áƒ‘áƒ¡ áƒáƒ“áƒ’áƒ˜áƒšáƒáƒ‘áƒ áƒ˜áƒ•áƒ˜ "áƒ©áƒáƒ›áƒáƒ áƒáƒ¡" áƒ™áƒ£áƒšáƒ¢áƒ£áƒ áƒ.</li>
                               <li><strong>áƒ¢áƒ£áƒ áƒ˜áƒ–áƒ›áƒ˜:</strong> áƒáƒáƒáƒ£áƒšáƒáƒ áƒ£áƒšáƒ˜ áƒ›áƒ˜áƒ›áƒáƒ áƒ—áƒ£áƒšáƒ”áƒ‘áƒáƒ áƒ˜áƒáƒáƒáƒœáƒ”áƒšáƒ˜ áƒ¢áƒ£áƒ áƒ˜áƒ¡áƒ¢áƒ”áƒ‘áƒ˜áƒ¡áƒ—áƒ•áƒ˜áƒ¡.</li>
                           </ul>` 
                }
            },
            'US Virgin Islands': {
                type: 'territory', flag: 'ğŸ‡»ğŸ‡®', region: 'Territories', pop: 105000,
                en: { 
                    title: "United States Virgin Islands", 
                    desc: `<p><strong>Overview:</strong> A group of Caribbean islands (Saint Croix, Saint John, and Saint Thomas). Purchased from Denmark in 1917.</p>
                           <ul>
                               <li><strong>Capital:</strong> Charlotte Amalie</li>
                               <li><strong>Unique Fact:</strong> It is the only place under U.S. jurisdiction where road traffic drives on the left.</li>
                               <li><strong>Economy:</strong> Heavily dependent on luxury tourism and rum production (Cruzan Rum).</li>
                               <li><strong>Nature:</strong> Known for pristine white sand beaches (Magens Bay) and coral reefs.</li>
                           </ul>` 
                },
                geo: { 
                    title: "áƒáƒ¨áƒ¨-áƒ˜áƒ¡ áƒ•áƒ˜áƒ áƒ¯áƒ˜áƒœáƒ˜áƒ˜áƒ¡ áƒ™áƒ£áƒœáƒ«áƒ£áƒšáƒ”áƒ‘áƒ˜", 
                    desc: `<p><strong>áƒ›áƒ˜áƒ›áƒáƒ®áƒ˜áƒšáƒ•áƒ:</strong> áƒ™áƒáƒ áƒ˜áƒ‘áƒ˜áƒ¡ áƒ–áƒ¦áƒ•áƒ˜áƒ¡ áƒ™áƒ£áƒœáƒ«áƒ£áƒšáƒ—áƒ áƒ¯áƒ’áƒ£áƒ¤áƒ˜ (áƒ¡áƒ”áƒœáƒ¢-áƒ™áƒ áƒ£áƒ, áƒ¡áƒ”áƒœáƒ¢-áƒ¯áƒáƒœáƒ˜, áƒ¡áƒ”áƒœáƒ¢-áƒ¢áƒáƒ›áƒáƒ¡áƒ˜). áƒáƒ¨áƒ¨-áƒ›áƒ áƒ¨áƒ”áƒ˜áƒ«áƒ˜áƒœáƒ áƒ“áƒáƒœáƒ˜áƒ˜áƒ¡áƒ’áƒáƒœ 1917 áƒ¬áƒ”áƒšáƒ¡.</p>
                           <ul>
                               <li><strong>áƒ“áƒ”áƒ“áƒáƒ¥áƒáƒšáƒáƒ¥áƒ˜:</strong> áƒ¨áƒáƒ áƒšáƒáƒ¢-áƒáƒ›áƒáƒšáƒ˜áƒ</li>
                               <li><strong>áƒ¤áƒáƒ¥áƒ¢áƒ˜:</strong> áƒ”áƒ áƒ—áƒáƒ“áƒ”áƒ áƒ—áƒ˜ áƒáƒ“áƒ’áƒ˜áƒšáƒ˜áƒ áƒáƒ¨áƒ¨-áƒ˜áƒ¡ áƒ˜áƒ£áƒ áƒ˜áƒ¡áƒ“áƒ˜áƒ¥áƒªáƒ˜áƒáƒ¨áƒ˜, áƒ¡áƒáƒ“áƒáƒª áƒ›áƒáƒ«áƒ áƒáƒáƒ‘áƒ áƒ›áƒáƒ áƒªáƒ®áƒ”áƒœáƒáƒ¡áƒáƒ­áƒ˜áƒáƒœáƒ˜áƒ.</li>
                               <li><strong>áƒ”áƒ™áƒáƒœáƒáƒ›áƒ˜áƒ™áƒ:</strong> áƒ”áƒ§áƒ áƒ“áƒœáƒáƒ‘áƒ áƒšáƒ£áƒ¥áƒ¡ áƒ™áƒšáƒáƒ¡áƒ˜áƒ¡ áƒ¢áƒ£áƒ áƒ˜áƒ–áƒ›áƒ¡ áƒ“áƒ áƒ áƒáƒ›áƒ˜áƒ¡ áƒ¬áƒáƒ áƒ›áƒáƒ”áƒ‘áƒáƒ¡.</li>
                               <li><strong>áƒ‘áƒ£áƒœáƒ”áƒ‘áƒ:</strong> áƒªáƒœáƒáƒ‘áƒ˜áƒšáƒ˜áƒ áƒ—áƒ”áƒ—áƒ áƒ˜ áƒ¥áƒ•áƒ˜áƒ¨áƒ˜áƒ¡ áƒáƒšáƒáƒŸáƒ”áƒ‘áƒ˜áƒ—áƒ áƒ“áƒ áƒ›áƒáƒ áƒ¯áƒœáƒ˜áƒ¡ áƒ áƒ˜áƒ¤áƒ”áƒ‘áƒ˜áƒ—.</li>
                           </ul>` 
                }
            },
            'American Samoa': {
                type: 'territory', flag: 'ğŸ‡¦ğŸ‡¸', region: 'Territories', pop: 45000,
                en: { 
                    title: "American Samoa", 
                    desc: `<p><strong>Overview:</strong> An unincorporated territory located in the South Pacific Ocean. It consists of five main islands and two coral atolls.</p>
                           <ul>
                               <li><strong>Capital:</strong> Pago Pago (known for its dramatic harbor).</li>
                               <li><strong>Status:</strong> Residents are U.S. Nationals, but not automatically U.S. Citizens (they cannot vote in federal elections but can live/work in the US).</li>
                               <li><strong>Culture:</strong> Strictly adheres to "Fa'a Samoa" (The Samoan Way), with a traditional chieftain system.</li>
                               <li><strong>Economy:</strong> Tuna fishing and processing is the backbone of the private sector.</li>
                           </ul>` 
                },
                geo: { 
                    title: "áƒáƒ›áƒ”áƒ áƒ˜áƒ™áƒ˜áƒ¡ áƒ¡áƒáƒ›áƒáƒ", 
                    desc: `<p><strong>áƒ›áƒ˜áƒ›áƒáƒ®áƒ˜áƒšáƒ•áƒ:</strong> áƒ¢áƒ”áƒ áƒ˜áƒ¢áƒáƒ áƒ˜áƒ áƒ¡áƒáƒ›áƒ®áƒ áƒ”áƒ— áƒ¬áƒ§áƒœáƒáƒ  áƒáƒ™áƒ”áƒáƒœáƒ”áƒ¨áƒ˜. áƒ¨áƒ”áƒ“áƒ’áƒ”áƒ‘áƒ 5 áƒ›áƒ—áƒáƒ•áƒáƒ áƒ˜ áƒ™áƒ£áƒœáƒ«áƒ£áƒšáƒ˜áƒ¡áƒ’áƒáƒœ.</p>
                           <ul>
                               <li><strong>áƒ“áƒ”áƒ“áƒáƒ¥áƒáƒšáƒáƒ¥áƒ˜:</strong> áƒáƒáƒ’áƒ-áƒáƒáƒ’áƒ (áƒªáƒœáƒáƒ‘áƒ˜áƒšáƒ˜áƒ áƒ—áƒáƒ•áƒ˜áƒ¡áƒ˜ áƒ¦áƒ áƒ›áƒáƒ¬áƒ§áƒšáƒáƒ•áƒáƒœáƒ˜ áƒáƒáƒ áƒ¢áƒ˜áƒ—).</li>
                               <li><strong>áƒ¡áƒ¢áƒáƒ¢áƒ£áƒ¡áƒ˜:</strong> áƒ›áƒªáƒ®áƒáƒ•áƒ áƒ”áƒ‘áƒšáƒ”áƒ‘áƒ˜ áƒáƒ áƒ˜áƒáƒœ "áƒáƒ¨áƒ¨-áƒ˜áƒ¡ áƒœáƒáƒªáƒ˜áƒáƒœáƒáƒšáƒ”áƒ‘áƒ˜", áƒ›áƒáƒ’áƒ áƒáƒ› áƒáƒ áƒ áƒ›áƒáƒ¥áƒáƒšáƒáƒ¥áƒ”áƒ”áƒ‘áƒ˜ (áƒáƒ  áƒáƒ¥áƒ•áƒ— áƒáƒ áƒ©áƒ”áƒ•áƒœáƒ”áƒ‘áƒ¨áƒ˜ áƒ®áƒ›áƒ˜áƒ¡ áƒ›áƒ˜áƒªáƒ”áƒ›áƒ˜áƒ¡ áƒ£áƒ¤áƒšáƒ”áƒ‘áƒ).</li>
                               <li><strong>áƒ™áƒ£áƒšáƒ¢áƒ£áƒ áƒ:</strong> áƒ›áƒ™áƒáƒªáƒ áƒáƒ“ áƒ˜áƒªáƒáƒ•áƒ”áƒœ "Fa'a Samoa"-áƒ¡ (áƒ¡áƒáƒ›áƒáƒ£áƒ áƒ˜ áƒªáƒ®áƒáƒ•áƒ áƒ”áƒ‘áƒ˜áƒ¡ áƒ¬áƒ”áƒ¡áƒ˜) áƒ¢áƒ áƒáƒ“áƒ˜áƒªáƒ˜áƒ”áƒ‘áƒ¡.</li>
                               <li><strong>áƒ”áƒ™áƒáƒœáƒáƒ›áƒ˜áƒ™áƒ:</strong> áƒ«áƒ˜áƒ áƒ˜áƒ—áƒáƒ“áƒ˜ áƒ“áƒáƒ áƒ’áƒ˜áƒ áƒ—áƒ˜áƒœáƒ£áƒ¡áƒ˜áƒ¡ áƒ—áƒ”áƒ•áƒ–áƒ­áƒ”áƒ áƒ áƒ“áƒ áƒ™áƒáƒœáƒ¡áƒ”áƒ áƒ•áƒ”áƒ‘áƒ˜áƒ¡ áƒ¬áƒáƒ áƒ›áƒáƒ”áƒ‘áƒ.</li>
                           </ul>` 
                }
            },
            'Northern Mariana Islands': {
                type: 'territory', flag: 'ğŸ‡²ğŸ‡µ', region: 'Territories', pop: 55000,
                en: { 
                    title: "Commonwealth of the Northern Mariana Islands (CNMI)", 
                    desc: `<p><strong>Overview:</strong> A commonwealth of the United States consisting of 14 islands in the northwestern Pacific Ocean. The most populated islands are Saipan, Tinian, and Rota.</p>
                           <ul>
                               <li><strong>Capital:</strong> Saipan</li>
                               <li><strong>History:</strong> Played a critical role in WWII (Battle of Saipan). The Enola Gay launched from Tinian.</li>
                               <li><strong>Economy:</strong> Relies on tourism and federal grants.</li>
                               <li><strong>Blue Hole:</strong> Famous for diving spots including "The Grotto".</li>
                           </ul>` 
                },
                geo: { 
                    title: "áƒ©áƒ áƒ“áƒ˜áƒšáƒáƒ”áƒ— áƒ›áƒáƒ áƒ˜áƒáƒœáƒáƒ¡ áƒ™áƒ£áƒœáƒ«áƒ£áƒšáƒ”áƒ‘áƒ˜", 
                    desc: `<p><strong>áƒ›áƒ˜áƒ›áƒáƒ®áƒ˜áƒšáƒ•áƒ:</strong> áƒáƒ¨áƒ¨-áƒ˜áƒ¡ áƒ—áƒáƒœáƒáƒ›áƒ”áƒ’áƒáƒ‘áƒ áƒáƒ‘áƒ áƒ¬áƒ§áƒœáƒáƒ  áƒáƒ™áƒ”áƒáƒœáƒ”áƒ¨áƒ˜, 14 áƒ™áƒ£áƒœáƒ«áƒ£áƒšáƒ˜. áƒ“áƒáƒ¡áƒáƒ®áƒšáƒ”áƒ‘áƒ£áƒšáƒ˜áƒ áƒ«áƒ˜áƒ áƒ˜áƒ—áƒáƒ“áƒáƒ“ áƒ¡áƒáƒ˜áƒáƒáƒœáƒ˜, áƒ¢áƒ˜áƒœáƒ˜áƒáƒœáƒ˜ áƒ“áƒ áƒ áƒáƒ¢áƒ.</p>
                           <ul>
                               <li><strong>áƒ“áƒ”áƒ“áƒáƒ¥áƒáƒšáƒáƒ¥áƒ˜:</strong> áƒ¡áƒáƒ˜áƒáƒáƒœáƒ˜</li>
                               <li><strong>áƒ˜áƒ¡áƒ¢áƒáƒ áƒ˜áƒ:</strong> áƒ›áƒ”áƒáƒ áƒ” áƒ›áƒ¡áƒáƒ¤áƒšáƒ˜áƒ áƒáƒ›áƒ˜áƒ¡ áƒ¡áƒáƒ™áƒ•áƒáƒœáƒ«áƒ áƒ¬áƒ”áƒ áƒ¢áƒ˜áƒšáƒ˜. áƒ¡áƒ¬áƒáƒ áƒ”áƒ“ áƒ¢áƒ˜áƒœáƒ˜áƒáƒœáƒ˜áƒ“áƒáƒœ áƒáƒ¤áƒ áƒ˜áƒœáƒ“áƒ áƒ‘áƒáƒ›áƒ‘áƒ“áƒáƒ›áƒ¨áƒ”áƒœáƒ˜, áƒ áƒáƒ›áƒ”áƒšáƒ›áƒáƒª áƒ°áƒ˜áƒ áƒáƒ¡áƒ˜áƒ›áƒ áƒ“áƒáƒ‘áƒáƒ›áƒ‘áƒ.</li>
                               <li><strong>áƒ”áƒ™áƒáƒœáƒáƒ›áƒ˜áƒ™áƒ:</strong> áƒ“áƒáƒ›áƒáƒ™áƒ˜áƒ“áƒ”áƒ‘áƒ£áƒšáƒ˜áƒ áƒ¢áƒ£áƒ áƒ˜áƒ–áƒ›áƒ–áƒ”.</li>
                               <li><strong>áƒ‘áƒ£áƒœáƒ”áƒ‘áƒ:</strong> áƒªáƒœáƒáƒ‘áƒ˜áƒšáƒ˜áƒ áƒ“áƒáƒ˜áƒ•áƒ˜áƒœáƒ’áƒ˜áƒ¡ áƒáƒ“áƒ’áƒ˜áƒšáƒ”áƒ‘áƒ˜áƒ— (áƒ›áƒáƒ’. "The Grotto").</li>
                           </ul>` 
                }
            },
            'California': { type: 'state', flag: 'ğŸ‡ºğŸ‡¸', region: 'West', pop: 39000000, en: { title: "California", desc: "The Golden State. Hub of tech and entertainment." }, geo: { title: "áƒ™áƒáƒšáƒ˜áƒ¤áƒáƒ áƒœáƒ˜áƒ", desc: "áƒáƒ¥áƒ áƒáƒ¡ áƒ¨áƒ¢áƒáƒ¢áƒ˜. áƒ¢áƒ”áƒ¥áƒœáƒáƒšáƒáƒ’áƒ˜áƒ”áƒ‘áƒ˜áƒ¡áƒ áƒ“áƒ áƒ’áƒáƒ áƒ—áƒáƒ‘áƒ˜áƒ¡ áƒªáƒ”áƒœáƒ¢áƒ áƒ˜." } },
            'Texas': { type: 'state', flag: 'ğŸ‡ºğŸ‡¸', region: 'South', pop: 29000000, en: { title: "Texas", desc: "The Lone Star State. Energy and Cowboys." }, geo: { title: "áƒ¢áƒ”áƒ®áƒáƒ¡áƒ˜", desc: "áƒ”áƒœáƒ”áƒ áƒ’áƒ”áƒ¢áƒ˜áƒ™áƒ áƒ“áƒ áƒ™áƒáƒ•áƒ‘áƒáƒ”áƒ‘áƒ˜." } },
            'New York': { type: 'state', flag: 'ğŸ‡ºğŸ‡¸', region: 'Northeast', pop: 19000000, en: { title: "New York", desc: "The Empire State. Finance and Culture." }, geo: { title: "áƒœáƒ˜áƒ£-áƒ˜áƒáƒ áƒ™áƒ˜", desc: "áƒ¤áƒ˜áƒœáƒáƒœáƒ¡áƒ”áƒ‘áƒ˜ áƒ“áƒ áƒ™áƒ£áƒšáƒ¢áƒ£áƒ áƒ." } },
            'Florida': { type: 'state', flag: 'ğŸ‡ºğŸ‡¸', region: 'South', pop: 21000000, en: { title: "Florida", desc: "The Sunshine State. Tourism and Beaches." }, geo: { title: "áƒ¤áƒšáƒáƒ áƒ˜áƒ“áƒ", desc: "áƒ›áƒ–áƒ˜áƒáƒœáƒ˜ áƒ¨áƒ¢áƒáƒ¢áƒ˜. áƒ¢áƒ£áƒ áƒ˜áƒ–áƒ›áƒ˜ áƒ“áƒ áƒáƒšáƒáƒŸáƒ”áƒ‘áƒ˜." } },
            'Illinois': { type: 'state', flag: 'ğŸ‡ºğŸ‡¸', region: 'Midwest', pop: 12000000, en: { title: "Illinois", desc: "Land of Lincoln. Chicago industry." }, geo: { title: "áƒ˜áƒšáƒ˜áƒœáƒáƒ˜áƒ¡áƒ˜", desc: "áƒšáƒ˜áƒœáƒ™áƒáƒšáƒœáƒ˜áƒ¡ áƒ›áƒ˜áƒ¬áƒ. áƒ©áƒ˜áƒ™áƒáƒ’áƒáƒ¡ áƒ˜áƒœáƒ“áƒ£áƒ¡áƒ¢áƒ áƒ˜áƒ." } }
        };

        // Complete List of States for rendering placeholders if data missing
        const ALL_STATES = [
            "Alabama", "Alaska", "Arizona", "Arkansas", "California", "Colorado", "Connecticut", "Delaware", "Florida", "Georgia", "Hawaii", "Idaho", "Illinois", "Indiana", "Iowa", "Kansas", "Kentucky", "Louisiana", "Maine", "Maryland", "Massachusetts", "Michigan", "Minnesota", "Mississippi", "Missouri", "Montana", "Nebraska", "Nevada", "New Hampshire", "New Jersey", "New Mexico", "New York", "North Carolina", "North Dakota", "Ohio", "Oklahoma", "Oregon", "Pennsylvania", "Rhode Island", "South Carolina", "South Dakota", "Tennessee", "Texas", "Utah", "Vermont", "Virginia", "Washington", "West Virginia", "Wisconsin", "Wyoming"
        ];

        let lang = 'en';
        let activeFilter = 'all';
        let regionFilter = null; // 'West', 'Midwest', etc.

        // --- PARTICLES SYSTEM (Custom Lightweight) ---
        const canvas = document.getElementById('particles-canvas');
        const ctx = canvas.getContext('2d');
        let particles = [];

        function resizeCanvas() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        }
        window.addEventListener('resize', resizeCanvas);
        resizeCanvas();

        class Particle {
            constructor() {
                this.x = Math.random() * canvas.width;
                this.y = Math.random() * canvas.height;
                this.vx = (Math.random() - 0.5) * 0.5;
                this.vy = (Math.random() - 0.5) * 0.5;
                this.size = Math.random() * 2 + 1;
            }
            update() {
                this.x += this.vx;
                this.y += this.vy;
                if(this.x < 0 || this.x > canvas.width) this.vx *= -1;
                if(this.y < 0 || this.y > canvas.height) this.vy *= -1;
            }
            draw() {
                ctx.fillStyle = 'rgba(0, 243, 255, 0.5)';
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
                ctx.fill();
            }
        }

        function initParticles() {
            particles = [];
            for(let i=0; i<80; i++) particles.push(new Particle());
        }

        function animateParticles() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            particles.forEach(p => {
                p.update();
                p.draw();
                // Connect lines
                particles.forEach(p2 => {
                    let dx = p.x - p2.x;
                    let dy = p.y - p2.y;
                    let dist = Math.sqrt(dx*dx + dy*dy);
                    if(dist < 100) {
                        ctx.strokeStyle = `rgba(0, 243, 255, ${0.1 - dist/1000})`;
                        ctx.lineWidth = 1;
                        ctx.beginPath();
                        ctx.moveTo(p.x, p.y);
                        ctx.lineTo(p2.x, p2.y);
                        ctx.stroke();
                    }
                });
            });
            requestAnimationFrame(animateParticles);
        }

        initParticles();
        animateParticles();

        // --- APP LOGIC ---

        function renderGrid() {
            const grid = document.getElementById('statesGrid');
            const search = document.getElementById('searchInput').value.toLowerCase();
            const sortType = document.getElementById('sortSelect').value;
            grid.innerHTML = '';

            let displayList = [];

            // 1. Compile Full List (Defined Data + Generic States)
            // Add defined objects
            for (let key in DATA) {
                displayList.push({ name: key, ...DATA[key], hasData: true });
            }
            // Add generic states if not already in DATA
            ALL_STATES.forEach(st => {
                if(!DATA[st]) {
                    displayList.push({ name: st, type: 'state', flag: 'ğŸ‡ºğŸ‡¸', region: 'Unknown', pop: 0, hasData: false });
                }
            });

            // 2. Filter
            displayList = displayList.filter(item => {
                // Search Text
                const matchesSearch = item.name.toLowerCase().includes(search);
                
                // Button Filter
                let matchesType = true;
                if(activeFilter === 'states' && item.type !== 'state') matchesType = false;
                if(activeFilter === 'territories' && item.type !== 'territory') matchesType = false;

                // Map Region Filter
                let matchesRegion = true;
                if(regionFilter && regionFilter !== 'Territories' && item.type === 'territory') matchesRegion = false;
                if(regionFilter === 'Territories' && item.type !== 'territory') matchesRegion = false;
                // Note: Real region logic for states would require a mapping of all 50 states to regions. 
                // For this demo, only defined states have regions. Generics are excluded if region filter is strict.
                if(regionFilter && item.hasData && item.region !== regionFilter && regionFilter !== 'Territories') matchesRegion = false;

                return matchesSearch && matchesType && matchesRegion;
            });

            // 3. Sort
            displayList.sort((a, b) => {
                if (sortType === 'name') return a.name.localeCompare(b.name);
                if (sortType === 'pop') return b.pop - a.pop;
            });

            // 4. Render
            displayList.forEach(item => {
                grid.appendChild(createCard(item));
            });
        }

        function createCard(item) {
            const div = document.createElement('div');
            
            // Border Color Logic
            let borderClass = 'border-blue';
            if(item.type === 'territory') borderClass = 'border-yellow';
            if(item.hasData && item.type === 'state') borderClass = 'border-green';

            div.className = `card ${borderClass}`;
            div.onclick = () => openModal(item);

            // Button Logic
            let btnClass = item.hasData ? 'btn-success' : 'btn-danger';
            let btnText = item.hasData 
                ? (lang === 'en' ? "ACCESS DATA" : "áƒ˜áƒœáƒ¤áƒáƒ¡ áƒœáƒáƒ®áƒ•áƒ") 
                : (lang === 'en' ? "LOCKED" : "áƒ“áƒáƒ‘áƒšáƒáƒ™áƒ˜áƒšáƒ˜áƒ");

            let popText = item.pop > 0 ? (item.pop / 1000000).toFixed(1) + 'M' : 'N/A';

            div.innerHTML = `
                <div>
                    <div class="card-header">
                        <div class="card-tag" style="color:${item.type==='territory'?'var(--neon-yellow)':'#888'}">${item.type.toUpperCase()}</div>
                        <div class="flag">${item.flag}</div>
                    </div>
                    <h3>${item.name}</h3>
                    <div class="stats-row">
                        <span>POP: ${popText}</span> | <span>RGN: ${item.region ? item.region.toUpperCase().substring(0,3) : 'UNK'}</span>
                    </div>
                </div>
                <div class="view-btn ${btnClass}">${btnText}</div>
            `;
            return div;
        }

        function filterByRegion(region) {
            // UI Update
            document.querySelectorAll('.map-region').forEach(el => el.classList.remove('active-region'));
            
            if (regionFilter === region) {
                // Toggle Off
                regionFilter = null;
            } else {
                // Toggle On
                regionFilter = region;
                const regionId = region === 'Territories' ? 'region-territories' : `region-${region.toLowerCase()}`;
                document.getElementById(regionId).classList.add('active-region');
            }
            renderGrid();
        }

        function setFilter(f) {
            activeFilter = f;
            document.querySelectorAll('.filter-buttons button').forEach(b => b.classList.remove('active'));
            document.getElementById(`btn-${f}`).classList.add('active');
            
            // Clear map filter when buttons used
            regionFilter = null;
            document.querySelectorAll('.map-region').forEach(el => el.classList.remove('active-region'));
            
            renderGrid();
        }

        function openModal(item) {
            const modal = document.getElementById('infoModal');
            const mTitle = document.getElementById('modalTitle');
            const mBody = document.getElementById('modalBody');

            modal.style.display = 'flex';
            setTimeout(() => modal.classList.add('show'), 10);

            if (item.hasData) {
                const content = item[lang];
                mTitle.innerText = content.title || item.name;
                mTitle.style.borderColor = item.type === 'territory' ? 'var(--neon-yellow)' : 'var(--neon-green)';
                mBody.innerHTML = content.desc;
            } else {
                mTitle.innerText = item.name;
                mTitle.style.borderColor = 'var(--neon-red)';
                mBody.innerHTML = lang === 'en' 
                    ? `<p style="color:var(--neon-red); text-align:center;">ACCESS DENIED. DATA NODE OFFLINE.</p>`
                    : `<p style="color:var(--neon-red); text-align:center;">áƒ¬áƒ•áƒ“áƒáƒ›áƒ áƒ¨áƒ”áƒ–áƒ¦áƒ£áƒ“áƒ£áƒšáƒ˜áƒ. áƒ›áƒáƒœáƒáƒªáƒ”áƒ›áƒ”áƒ‘áƒ˜ áƒáƒ  áƒáƒ áƒ˜áƒ¡.</p>`;
            }
        }

        function closeModal(e, force) {
            if (force || e.target.id === 'infoModal') {
                const modal = document.getElementById('infoModal');
                modal.classList.remove('show');
                setTimeout(() => modal.style.display = 'none', 300);
            }
        }

        function toggleLang() {
            lang = lang === 'en' ? 'geo' : 'en';
            document.getElementById('langBtn').innerText = `LANG: ${lang.toUpperCase()}`;
            document.getElementById('searchInput').placeholder = lang === 'en' ? "SEARCH NODE..." : "áƒ«áƒ˜áƒ”áƒ‘áƒ...";
            renderGrid();
        }

        // Initial Render
        renderGrid();

    </script>
</body>
</html>
